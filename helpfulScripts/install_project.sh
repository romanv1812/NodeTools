#!/bin/bash

# Функция для запроса пользователя о репозитории проекта
function ask_for_repo {
    read -p "Введите URL репозитория проекта: " repo_url
}

# Функция для выбора версии релиза
function select_release {
    # Получение списка доступных версий
    releases=$(curl -s "${repo_url}/releases" | grep -o '"tag_name": "[^"]*' | grep -o '[^"]*$')
    
    # Вывод списка версий
    echo "Доступные версии релиза:"
    select version in $releases "Выбрать другую версию"; do
        if [ "$version" == "Выбрать другую версию" ]; then
            return 1
        elif [ -n "$version" ]; then
            selected_version="$version"
            return 0
        else
            echo "Пожалуйста, выберите версию из списка."
        fi
    done
}

# Функция для предложения выбора: скачать готовый файл или собрать из исходного кода
function select_action {
    echo "Выберите действие:"
    select action in "Скачать готовый файл" "Собрать из исходного кода"; do
        case $action in
            "Скачать готовый файл")
                # Здесь можно добавить код для скачивания готового файла (если доступно)
                echo "Скачивание готового файла..."
                # Замените следующую строку на команду для скачивания файла
                echo "Команда для скачивания готового файла"
                break
                ;;
            "Собрать из исходного кода")
                # Сборка проекта с помощью Go (или другого инструмента)
                echo "Сборка проекта с версией $selected_version..."
                # Здесь добавьте команду для сборки проекта
                break
                ;;
            *)
                echo "Выберите вариант 1 или 2."
                ;;
        esac
    done
}

# Запрос репозитория проекта
ask_for_repo

# Запрос пользователя о версии релиза
while true; do
    select_release
    if [ $? -eq 0 ]; then
        break
    fi
done

# Вывод выбранной версии и запрос пользователя о действии
echo "Выбранная версия: $selected_version"
read -p "Установить эту версию? (y/n): " install_version

if [[ "$install_version" == "y" || "$install_version" == "Y" ]]; then
    # Выбор действия (скачать готовый файл или собрать из исходного кода)
    select_action
else
    echo "Вы отказались от установки."
fi
